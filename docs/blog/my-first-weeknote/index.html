<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Use the title from a page's frontmatter if it has one -->
    <title>My first weeknote</title>
    <link href="/stylesheets/styles.css" rel="stylesheet" />
  </head>
  <body>
    <div class="header">
      <a href="/">Richard Towers</a>
    </div>
    <main>
      <div class="content">
      <h1 id="my-first-weeknote">My first weeknote</h1>

<p>This year I'm going to try writing personal weeknotes.</p>

<p>Each week I'll look back at the things I did (mostly work things), and write a summary. I hope this will be an opportunity for me to think about how I spend my time, and a record for me to look back over. I'm keen to improve my writing style too, and there's nothing like regular practice.</p>

<p>There are a few folk at work who have been writing weeknotes for years. I think it's amazing to be able to maintain that habit, and their notes must be a great asset for them. Thanks in particular to <a href="https://visitmy.website/2020/11/01/why-i-write-weeknotes/">Steve</a>, <a href="https://memo.barrucadu.co.uk/taxon/weeknotes.html">Michael</a> and <a href="https://tobiogunsina.com/category/weeknotes/">Tobi</a> for the inspiration.</p>

<p>So, Week 1, 2021. How did it go?</p>

<p>It was a very tough start to the year.</p>

<h2 id="outside-work">Outside work</h2>

<p>The coronavirus pandemic in the UK is reaching terrifying levels, with signs that things will get much worse before they get better.</p>

<p>In the USA there were unbelievable scenes. Outgoing president Donald Trump's supporters stormed congress in an attempt to prevent it from certifying the election results.</p>

<p>If reality had been a film, I would have pointed out some gaping plot holes. The idea that the security of the Capitol building could be overwhelmed by a disorganized, lightly armed mob, simply by pushing their way in? Ridiculous. And yet, here we are.</p>

<p>"Big Tech" has been in the news, with Twitter permanently banning the president of the USA from their platform. Amazon Web Services plan to shut down the hosting for Parler (a less moderated social network, favoured by extremists). This has brought a sharp focus on the ethical implications of working in technology, and perhaps on the power of workers and unions to influence the behaviour of these huge companies.</p>

<p>On Wednesday I attended my Grandmother's funeral. Despite all the restrictions in place, it was good to be together with (although socially distant from) my family. We remembered a wonderful person, and a life filled with optimism and love. I read some verses from Philippians, and managed not to stumble over the words.</p>

<h2 id="at-work">At work</h2>

<h3 id="scaling-and-observability">Scaling and observability</h3>

<p>We spent the end of last year worrying about scale. Regular coronavirus press conferences drove floods of traffic to GOV.UK, with people trying to work out what the rules would be in their area.</p>

<p>This week saw possibly the biggest spike in traffic GOV.UK has ever handled. At the peak, our content delivery network was serving 88,000 requests per second.</p>

<p>For the most part, everything worked perfectly. We served 17,000,000 pages, of which only 21 were errors.</p>

<p>Behind the scenes though, I felt our observability could have been better. Although we have lots of monitoring (metrics, logs, alerts, analytics, smoke tests, synthetic monitoring), there never seems to be a single place for people to look at during these interesting times.</p>

<p><a href="https://twitter.com/TheRealNooshu/status/1346183432876019712">Matt shared some of the graphs we were looking at on twitter</a>. Initially, we were looking at analytics. That's flawed because it's opt-in, but it shows the trends in real time. At this scale though, our analytics provider decided that discretion was the better part of valour and disabled real time monitoring.</p>

<p>So we switched to looking at CDN metrics. These are great, because they're the truest measure of the scale of traffic we're serving to users. But we don't pull real-time CDN metrics into our main dashboards yet, so they're another thing people have to sign in to to see what's going on.</p>

<p>CDN metrics also don't tell us which pages are seeing the most traffic. For an authoritative view on that, we use CDN logs. These are in another system again.</p>

<p>Because this is all a bit messy, I spent a fair bit of the week thinking about how we can improve our monitoring. I <a href="https://github.com/alphagov/packager/pull/187">upgraded our prometheus instance</a>, and <a href="https://github.com/alphagov/govuk-aws/pull/1403">fixed a longstanding issue which meant we couldn't use prometheus from Grafana</a>.</p>

<p>I had a play with a prometheus exporter for Fastly's real-time analytics API, which would allow us to see live metrics from our CDN on our primary dashboards. I wonder whether a Fastly datasource for Grafana might be a more elegant solution though.</p>

<p>Later in the week I attended an incident review about a different traffic spike that hadn't been handled quite so well. There are still some uncomfortable unknowns about how and when our systems fail when under unprecedented load. We plan to do some systematic load testing to understand where the bottlenecks are.</p>

<h3 id="thinking-about-strategy">Thinking about strategy</h3>

<p>As a little side project, I've been taking GOV.UK's flagship content management system (imaginatively called "<a href="https://github.com/alphagov/content-publisher">content-publisher</a>") and <a href="https://github.com/alphagov/content-publisher/compare/alphagov:9d21178...richardTowers:80ae12f">hacking it</a> so I can use it to publish my personal blog instead of content on GOV.UK. It's not quite ready to be used for real yet, but most of the hard work is done.</p>

<p>I demoed this to my opposite numbers in Product and Delivery, and it provoked an excellent discussion.</p>

<p>Firstly, having the application running as a monolith (without GOV.UK's many other microservices) provokes a good question about how complicated our infrastructure really needs to be. Yes, a blog is not as complicated as a national government website, but how much harder can it be really? If there's a complexity / functionality trade-off, are we getting that right at the moment?</p>

<p>Secondly, we discussed the amount of bespoke page designs we've had to produce over the last couple of years with Brexit and coronavirus. Because none of our content management systems quite fit the bill for these bits of content, producing these pages has cost us a lot of engineering time. content-publisher is nearly there though, so perhaps it's worth revisiting this user need.</p>

<p>I'm going to demo the same thing in our next GOV.UK Tech Fortnightly meeting. Many of my colleagues are a lot more familiar with GOV.UK than I am, so I hope this will provoke another good discussion.</p>

<h3 id="replatforming">Replatforming</h3>

<p>The GOV.UK Replatforming team are working out how to host GOV.UK's services on a managed container platform (namely AWS ECS, although other hyperscale cloud providers are available).</p>

<p>I've been helping them refactor their infrastructure-as-code to try to keep it as simple as possible. I finished my <a href="https://github.com/alphagov/govuk-infrastructure/pull/109">refactoring of our content-store deployment</a>, and did some pair-programming on the same refactoring for the "publisher" application.</p>

<p>The way Terraform and the AWS ECS API interact around task definitions <a href="https://github.com/hashicorp/terraform-provider-aws/issues/632">makes it really difficult to do what we want to do</a> in a nice way. This is bothering me, but we're yet to come up with a better solution than the one we're implementing at the moment. We had some conversations about other tools, like <a href="https://www.pulumi.com/">pulumi</a>, <a href="https://cuelang.org/docs/about/">cue</a>, and <a href="https://dhall-lang.org/#">dhall</a>, but I think adding a new piece of configuration management technology to our stack is probably a nuclear option.</p>

<h3 id="other-things">Other things</h3>

<p>We're getting the ball rolling again on a developer recruitment campaign we kicked off last year. We need to schedule lots of phone interviews, and start lining up face-to-face interviews. Although I made some progress, most of this still needs to get sorted out next week.</p>

<h2 id="end-of-weeknote">End of weeknote</h2>

<p>â€¦ well, that was a lot longer than I expected it would be. The next ones will have to be shorter, or I'm never going to sustain this habit.</p>

<p>If you can believe it, I actually felt a little unproductive last week, but looking back at it I think that I got a lot done. Especially as circumstances weren't ideal.</p>

<p>Next week I hope to get our recruitment moving again, provoke some interesting thoughts and conversations, and make some progress with my observability work and the infrastructure-as-code refactoring.</p>


      </div>
    </main>
    <footer>
      <img alt="doge" src="/images/doge.png"> Copyleft Richard Towers 2021. All wrongs reserved.
    </footer>
  </body>
</html>
